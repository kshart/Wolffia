"use strict";var XBBCODE=(function(){var u={},e=/^(?:https?|file|c):(?:\/{1,3}|\\{1})[-a-zA-Z0-9:;@#%&()~_?\+=\/\\\.]*$/,d=/^(?:aliceblue|antiquewhite|aqua|aquamarine|azure|beige|bisque|black|blanchedalmond|blue|blueviolet|brown|burlywood|cadetblue|chartreuse|chocolate|coral|cornflowerblue|cornsilk|crimson|cyan|darkblue|darkcyan|darkgoldenrod|darkgray|darkgreen|darkkhaki|darkmagenta|darkolivegreen|darkorange|darkorchid|darkred|darksalmon|darkseagreen|darkslateblue|darkslategray|darkturquoise|darkviolet|deeppink|deepskyblue|dimgray|dodgerblue|firebrick|floralwhite|forestgreen|fuchsia|gainsboro|ghostwhite|gold|goldenrod|gray|green|greenyellow|honeydew|hotpink|indianred|indigo|ivory|khaki|lavender|lavenderblush|lawngreen|lemonchiffon|lightblue|lightcoral|lightcyan|lightgoldenrodyellow|lightgray|lightgreen|lightpink|lightsalmon|lightseagreen|lightskyblue|lightslategray|lightsteelblue|lightyellow|lime|limegreen|linen|magenta|maroon|mediumaquamarine|mediumblue|mediumorchid|mediumpurple|mediumseagreen|mediumslateblue|mediumspringgreen|mediumturquoise|mediumvioletred|midnightblue|mintcream|mistyrose|moccasin|navajowhite|navy|oldlace|olive|olivedrab|orange|orangered|orchid|palegoldenrod|palegreen|paleturquoise|palevioletred|papayawhip|peachpuff|peru|pink|plum|powderblue|purple|red|rosybrown|royalblue|saddlebrown|salmon|sandybrown|seagreen|seashell|sienna|silver|skyblue|slateblue|slategray|snow|springgreen|steelblue|tan|teal|thistle|tomato|turquoise|violet|wheat|white|whitesmoke|yellow|yellowgreen)$/,b=/^#?[a-fA-F0-9]{6}$/,s=/^[a-zA-Z0-9\-]+$/,p=/[^\s@]+@[^\s@]+\.[^\s@]+/,t=/^([a-z][a-z0-9_]+|"[a-z][a-z0-9_\s]+")$/i,g,w,k=[],q,c,l,m,a;g={b:{openTag:function(y,x){return'<span class="xbbcode-b">'},closeTag:function(y,x){return"</span>"}},bbcode:{openTag:function(y,x){return""},closeTag:function(y,x){return""}},center:{openTag:function(y,x){return'<span class="xbbcode-center">'},closeTag:function(y,x){return"</span>"}},code:{openTag:function(y,x){return'<span class="xbbcode-code">'},closeTag:function(y,x){return"</span>"},noParse:true},color:{openTag:function(z,y){var x=(z.substr(1)).toLowerCase()||"black";d.lastIndex=0;b.lastIndex=0;if(!d.test(x)){if(!b.test(x)){x="black"}else{if(x.substr(0,1)!=="#"){x="#"+x}}}return'<span style="color:'+x+'">'},closeTag:function(y,x){return"</span>"}},email:{openTag:function(z,y){var x;if(!z){x=y.replace(/<.*?>/g,"")}else{x=z.substr(1)}p.lastIndex=0;if(!p.test(x)){return"<a>"}return'<a href="mailto:'+x+'">'},closeTag:function(y,x){return"</a>"}},face:{openTag:function(z,y){var x=z.substr(1)||"inherit";t.lastIndex=0;if(!t.test(x)){x="inherit"}return'<span style="font-family:'+x+'">'},closeTag:function(y,x){return"</span>"}},font:{openTag:function(z,y){var x=z.substr(1)||"inherit";t.lastIndex=0;if(!t.test(x)){x="inherit"}return'<span style="font-family:'+x+'">'},closeTag:function(y,x){return"</span>"}},i:{openTag:function(y,x){return'<span class="xbbcode-i">'},closeTag:function(y,x){return"</span>"}},img:{openTag:function(z,y){var x=y;e.lastIndex=0;if(!e.test(x)){x=""}return'<img class="img-responsive center-block" src="'+x+'" />'},closeTag:function(y,x){return""},displayContent:false},justify:{openTag:function(y,x){return'<span class="xbbcode-justify">'},closeTag:function(y,x){return"</span>"}},large:{openTag:function(z,y){var z=z||"";var x=z.substr(1)||"inherit";d.lastIndex=0;b.lastIndex=0;if(!d.test(x)){if(!b.test(x)){x="inherit"}else{if(x.substr(0,1)!=="#"){x="#"+x}}}return'<span class="xbbcode-size-36" style="color:'+x+'">'},closeTag:function(y,x){return"</span>"}},left:{openTag:function(y,x){return'<span class="xbbcode-left">'},closeTag:function(y,x){return"</span>"}},li:{openTag:function(y,x){return"<li>"},closeTag:function(y,x){return"</li>"},restrictParentsTo:["list","ul","ol"]},list:{openTag:function(y,x){return"<ul>"},closeTag:function(y,x){return"</ul>"},restrictChildrenTo:["*","li"]},noparse:{openTag:function(y,x){return""},closeTag:function(y,x){return""},noParse:true},ol:{openTag:function(y,x){return"<ol>"},closeTag:function(y,x){return"</ol>"},restrictChildrenTo:["*","li"]},php:{openTag:function(y,x){return'<span class="xbbcode-code">'},closeTag:function(y,x){return"</span>"},noParse:true},quote:{openTag:function(y,x){return'<blockquote class="xbbcode-blockquote">'},closeTag:function(y,x){return"</blockquote>"}},right:{openTag:function(y,x){return'<span class="xbbcode-right">'},closeTag:function(y,x){return"</span>"}},s:{openTag:function(y,x){return'<span class="xbbcode-s">'},closeTag:function(y,x){return"</span>"}},size:{openTag:function(z,y){var x=parseInt(z.substr(1),10)||0;if(x<4||x>40){x=14}return'<span class="xbbcode-size-'+x+'">'},closeTag:function(y,x){return"</span>"}},sub:{openTag:function(y,x){return"<sub>"},closeTag:function(y,x){return"</sub>"}},sup:{openTag:function(y,x){return"<sup>"},closeTag:function(y,x){return"</sup>"}},table:{openTag:function(y,x){return'<table class="xbbcode-table">'},closeTag:function(y,x){return"</table>"},restrictChildrenTo:["tbody","thead","tfoot","tr"]},tbody:{openTag:function(y,x){return"<tbody>"},closeTag:function(y,x){return"</tbody>"},restrictChildrenTo:["tr"],restrictParentsTo:["table"]},tfoot:{openTag:function(y,x){return"<tfoot>"},closeTag:function(y,x){return"</tfoot>"},restrictChildrenTo:["tr"],restrictParentsTo:["table"]},thead:{openTag:function(y,x){return'<thead class="xbbcode-thead">'},closeTag:function(y,x){return"</thead>"},restrictChildrenTo:["tr"],restrictParentsTo:["table"]},td:{openTag:function(y,x){return'<td class="xbbcode-td">'},closeTag:function(y,x){return"</td>"},restrictParentsTo:["tr"]},th:{openTag:function(y,x){return'<th class="xbbcode-th">'},closeTag:function(y,x){return"</th>"},restrictParentsTo:["tr"]},tr:{openTag:function(y,x){return'<tr class="xbbcode-tr">'},closeTag:function(y,x){return"</tr>"},restrictChildrenTo:["td","th"],restrictParentsTo:["table","tbody","tfoot","thead"]},u:{openTag:function(y,x){return'<span class="xbbcode-u">'},closeTag:function(y,x){return"</span>"}},ul:{openTag:function(y,x){return"<ul>"},closeTag:function(y,x){return"</ul>"},restrictChildrenTo:["*","li"]},url:{openTag:function(z,y){var x;if(!z){x=y.replace(/<.*?>/g,"")}else{x=z.substr(1)}e.lastIndex=0;if(!e.test(x)){x="#"}return'<a href="'+x+'">'},closeTag:function(y,x){return"</a>"}},icon:{openTag:function(y,x){if(!s.test(x)){x=""}return'<span class="glyphicon '+x+'" aria-hidden="true"></span>'},closeTag:function(y,x){return""},displayContent:false},row:{openTag:function(y,x){return'<div class="row">'},closeTag:function(y,x){return"</div>"},restrictChildrenTo:["col"]},col:{openTag:function(y,x){if(y==undefined||y==""){return'<div class="col-md-12" style="margin-bottom:30px">'}else{return'<div class="col-'+(y.substr(1)||"md-12")+'" style="margin-bottom:30px">'}},closeTag:function(y,x){return"</div>"},restrictParentsTo:["row"]},p:{openTag:function(y,x){if(y==undefined||y==""){return"<p>"}else{return'<p class="'+y.substr(1)+'">'}},closeTag:function(y,x){return"</p>"},restrictChildrenTo:["strong","small"]},strong:{openTag:function(y,x){return"<strong>"},closeTag:function(y,x){return"</strong>"},restrictParentsTo:["p","h1","h2","h3","h4","h5","h6"]},small:{openTag:function(y,x){return"<small>"},closeTag:function(y,x){return"</small>"},restrictParentsTo:["p","h1","h2","h3","h4","h5","h6"]},h1:{openTag:function(y,x){if(y==undefined||y==""){return'<h1 class="csa">'}else{return'<h1 class="'+y.substr(1)+'">'}},closeTag:function(y,x){return"</h1>"},restrictChildrenTo:["strong","small"]},h2:{openTag:function(y,x){if(y==undefined||y==""){return"<h2>"}else{return'<h2 class="'+y.substr(1)+'">'}},closeTag:function(y,x){return"</h2>"},restrictChildrenTo:["strong","small"]},h3:{openTag:function(y,x){if(y==undefined||y==""){return"<h3>"}else{return'<h3 class="'+y.substr(1)+'">'}},closeTag:function(y,x){return"</h3>"},restrictChildrenTo:["strong","small"]},h4:{openTag:function(y,x){if(y==undefined||y==""){return"<h4>"}else{return'<h4 class="'+y.substr(1)+'">'}},closeTag:function(y,x){return"</h4>"},restrictChildrenTo:["strong","small"]},h5:{openTag:function(y,x){if(y==undefined||y==""){return"<h5>"}else{return'<h5 class="'+y.substr(1)+'">'}},closeTag:function(y,x){return"</h5>"},restrictChildrenTo:["strong","small"]},h6:{openTag:function(y,x){if(y==undefined||y==""){return"<h6>"}else{return'<h6 class="'+y.substr(1)+'">'}},closeTag:function(y,x){return"</h6>"},restrictChildrenTo:["strong","small"]},video:{openTag:function(y,x){if(y==undefined||y==""){return'<div class="embed-responsive embed-responsive-16by9">'}else{return'<h1 class="'+y.substr(1)||'16by9">'}},closeTag:function(y,x){return"</div>"},restrictChildrenTo:["youtube"]},youtube:{openTag:function(y,x){return'<iframe class="embed-responsive-item" src="'},closeTag:function(y,x){return'"></iframe>'},restrictParentsTo:["video"]},imglib:{openTag:function(z,y){var x=new Number(y);if(x!=NaN){return'<img class="img-responsive center-block" src="/images/'+x+'" />'}return'<img class="img-responsive center-block" src="#"/>'},closeTag:function(y,x){return""},displayContent:false},"*":{openTag:function(y,x){return"<li>"},closeTag:function(y,x){return"</li>"},restrictParentsTo:["list","ul","ol"]}};function f(){w=[];var z,y,x;for(z in g){if(g.hasOwnProperty(z)){if(z==="*"){w.push("\\"+z)}else{w.push(z);if(g[z].noParse){k.push(z)}}g[z].validChildLookup={};g[z].validParentLookup={};g[z].restrictParentsTo=g[z].restrictParentsTo||[];g[z].restrictChildrenTo=g[z].restrictChildrenTo||[];x=g[z].restrictChildrenTo.length;for(y=0;y<x;y++){g[z].validChildLookup[g[z].restrictChildrenTo[y]]=true}x=g[z].restrictParentsTo.length;for(y=0;y<x;y++){g[z].validParentLookup[g[z].restrictParentsTo[y]]=true}}}q=new RegExp("<bbcl=([0-9]+) ("+w.join("|")+")([ =][^>]*?)?>((?:.|[\\r\\n])*?)<bbcl=\\1 /\\2>","gi");c=new RegExp("\\[("+w.join("|")+")([ =][^\\]]*?)?\\]([^\\[]*?)\\[/\\1\\]","gi");l=new RegExp("\\[("+k.join("|")+")([ =][^\\]]*?)?\\]([\\s\\S]*?)\\[/\\1\\]","gi");(function(){var B=[];for(var A=0;A<w.length;A++){if(w[A]!=="\\*"){B.push("/"+w[A])}}m=new RegExp("(\\[)((?:"+w.join("|")+")(?:[ =][^\\]]*?)?)(\\])","gi");a=new RegExp("(\\[)("+B.join("|")+")(\\])","gi")})()}f();function n(K,F,E,A,y,z,L){L=L||[];E++;var B=new RegExp("(<bbcl="+E+" )("+w.join("|")+")([ =>])","gi"),D=new RegExp("(<bbcl="+E+" )("+w.join("|")+")([ =>])","i"),J=z.match(B)||[],I,x,H,C,G=g[K]||{};B.lastIndex=0;if(!J){z=""}for(H=0;H<J.length;H++){D.lastIndex=0;C=(J[H].match(D))[2].toLowerCase();if(G&&G.restrictChildrenTo&&G.restrictChildrenTo.length>0){if(!G.validChildLookup[C]){x='The tag "'+C+'" is not allowed as a child of the tag "'+K+'".';L.push(x)}}I=g[C]||{};if(I.restrictParentsTo.length>0){if(!I.validParentLookup[K]){x='The tag "'+K+'" is not allowed as a parent of the tag "'+C+'".';L.push(x)}}}z=z.replace(q,function(M,N,O,P,Q){L=n(O.toLowerCase(),M,N,O,P,Q,L);return M});return L}function v(x){x=x.replace(/\<([^\>][^\>]*?)\>/gi,function(y,A){var z=A.match(/^bbcl=([0-9]+) /);if(z===null){return"<bbcl=0 "+A+">"}else{return"<"+A.replace(/^(bbcl=)([0-9]+)/,function(B,D,C){return D+(parseInt(C,10)+1)})+">"}});return x}function o(x){return x.replace(/<bbcl=[0-9]+ \/\*>/gi,"").replace(/<bbcl=[0-9]+ /gi,"&#91;").replace(/>/gi,"&#93;")}var r=function(x,y,C,D,E){C=C.toLowerCase();var B=g[C].noParse?o(E):E.replace(q,r),A=g[C].openTag(D,B),z=g[C].closeTag(D,B);if(g[C].displayContent===false){B=""}return A+B+z};function i(y){var x=y.text;x=x.replace(q,r);return x}function j(x){x=x.replace(/\[(?!\*[ =\]]|list([ =][^\]]*)?\]|\/list[\]])/ig,"<");x=x.replace(/\[(?=list([ =][^\]]*)?\]|\/list[\]])/ig,">");while(x!==(x=x.replace(/>list([ =][^\]]*)?\]([^>]*?)(>\/list])/gi,function(y,B,z){var A=y;while(A!==(A=A.replace(/\[\*\]([^\[]*?)(\[\*\]|>\/list])/i,function(C,E,D){if(D.toLowerCase()===">/list]"){D="</*]</list]"}else{D="</*][*]"}return"<*]"+E+D}))){}A=A.replace(/>/g,"<");return A}))){}x=x.replace(/</g,"[");return x}function h(x){while(x!==(x=x.replace(c,function(y,z,A,B){y=y.replace(/\[/g,"<");y=y.replace(/\]/g,">");return v(y)}))){}return x}u.tags=function(){return g};u.addTags=function(y){var x;for(x in y){g[x]=y[x]}f()};u.process=function(z){var y={html:"",error:false},x=[];z.text=z.text.replace(/</g,"&lt;");z.text=z.text.replace(/>/g,"&gt;");z.text=z.text.replace(m,function(A,B,D,C){return"<"+D+">"});z.text=z.text.replace(a,function(A,B,D,C){return"<"+D+">"});z.text=z.text.replace(/\[/g,"&#91;");z.text=z.text.replace(/\]/g,"&#93;");z.text=z.text.replace(/</g,"[");z.text=z.text.replace(/>/g,"]");while(z.text!==(z.text=z.text.replace(l,function(A,B,C,D){D=D.replace(/\[/g,"&#91;");D=D.replace(/\]/g,"&#93;");C=C||"";D=D||"";return"["+B+C+"]"+D+"[/"+B+"]"}))){}z.text=h(z.text);x=n("bbcode",z.text,-1,"","",z.text);y.html=i(z);if(y.html.indexOf("[")!==-1||y.html.indexOf("]")!==-1){x.push("Some tags appear to be misaligned.")}if(z.removeMisalignedTags){y.html=y.html.replace(/\[.*?\]/g,"")}if(z.addInLineBreaks){y.html='<div style="white-space:pre;">'+y.html+"</div>"}y.html=y.html.replace("&#91;","[");y.html=y.html.replace("&#93;","]");y.error=x.length!==0;y.errorQueue=x;return y};return u})();